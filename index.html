    // 更新状态信息
    function updateStatus(message) {
        document.getElementById('status').textContent = message;
        console.log(message);
    }
    
    // 获取URL中的目标网址参数
    let targetUrl = getUrlParameter('url');
    const webhookUrl = 'https://r5d5uzik80.feishu.cn/base/workflow/webhook/event/ZEmWaxw5IwBDDZhJt1Gcyxytntd';

    // 验证目标网址
    if (!targetUrl) {
        updateStatus('错误：未提供目标网址参数');
    } else {

        // 确保网址有协议头
        if (!targetUrl.startsWith('http://') && !targetUrl.startsWith('https://')) {
            targetUrl = 'https://' + targetUrl;
        }

        updateStatus('开始发送Webhook请求...');

        // 设置超时机制（5秒后强制跳转）
        const timeoutId = setTimeout(() => {
            updateStatus('Webhook请求超时，直接跳转...');
            window.location.href = targetUrl;
        }, 5000);

        // 发送POST请求到Webhook
        fetch(webhookUrl, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({
                name: targetUrl
            })
        })
        .then(response => {
            clearTimeout(timeoutId);
            if (!response.ok) {
                throw new Error(`HTTP error! status: ${response.status}`);
            }
            updateStatus('Webhook调用成功，正在跳转...');
            window.location.href = targetUrl;
        })
        .catch(error => {
            clearTimeout(timeoutId);
            updateStatus('Webhook调用失败: ' + error.message + '，直接跳转...');
            console.error('Webhook错误详情:', error);
            window.location.href = targetUrl;
        });
    }
</script>
